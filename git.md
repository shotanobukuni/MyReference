# Gitに関するmemo

## 参考サイト
纏めておいてあれですが、以下のサイトがとてもよくまとまっていました。。  
参考Qiitaサイト[Link](https://qiita.com/kamihork/items/36992c14c70b7477f40e)

## Gitに関する単語まとめ  
* gitの4つのステージ  
gitとはソースコード管理ツールである。  
ソースコードを以下の４つのステージで管理する。  
```
リモートリポジトリ : GitHub,Gerrit等のソースコード
ローカルリポジトリ : push前の状態
ステージングエリア : git addした状態
ワーキングディレクトリ : 作業環境
```
* ブランチに関して
```
リモートブランチ : リモートリポジトリにあるブランチ
リモート追跡ブランチ(上流ブランチ) : origin/masterとか
追跡ブランチ(ローカルブランチ) : masterとか普通のやつ
```

## ソースコード取得~pushまで(同じブランチで作業する場合)

できる限り操作順に纏める
* リモートリポジトリからソースコードを持ってくる(git clone)  
基本的に最初はこれを行う
あとは、pullするほうが良い(環境差分をなくすため)
```
git clone <リポジトリURL> -b <ブランチ名>or<タグ名>
```
***
* 現在の状態を確認する(git status)  
ソースコードが現在どの状態にいるのかを確認する
```
git status (-sb)
```
-sbオプションをつけると、ブランチ名を表示かつ簡略化して表示してくれる  
慣れたらこれでよいと思います
***
* 編集したファイルをcommitできる状態にする(git add)  

ワーキングディレクトリで編集したファイルをステージングエリアに移すこと
```
git add <ファイル名>
```
全て加えたいなら
```
git add .
```
***
* 変更箇所を確認する(git diff)  
commit前に必ず編集による変更箇所を確認すること!!  
そしてその差分を可能ならリダイレクトする  
```
git diff
```
***
* ステージングエリアのファイルをpush出来るようにする(git commit)  
ステージングエリアに加えたファイルをpush出来るようにする    
(ステージングエリアのファイルをローカルリポジトリに移す)  
そのためにはcommitメッセージを加える必要がある  
※commitごとのハッシュ値が確定する  
```
git commit -m <commitメッセージ１行目>( -m <commitメッセージ2行目>…)
```
複数行つけたい場合、-mを分ける
***
* commit履歴を確認する(git log)  
commit履歴を確認する  
※ローカルリポジトリの履歴であることに注意!!  
pushしていなくてもcommitすれば履歴が更新される  
つまり、commit直後はリモートリポジトリとローカルリポジトリで  commit履歴に差分がある  
```
git log
```
***
* リモートリポジトリ(GitHub等)に反映する(git push)  
リモートリポジトリに反映するため慎重に操作する  
まずは今いるブランチを再度確認する
```
git branch (-a)
```
ここで緑色になっているのが今いるブランチ
-a でリモートリポジトリも合わせて表示する  
ブランチに間違いがないことを確認して

```
git push -u origin <ブランチ名>
```
origin : リモートリポジトリにpushするためのオプション  
-u <ブランチ名> : 上流ブランチを指定する  

## 別ブランチで作業する(checkout~marge)
* ブランチアウトする  
基本的にマスターブランチに対してブランチアウトしてマージするのが基本  
```
git checkout -b <ブランチ名>
```

* リモートリポジトリから最新ソースコードを持ってくる  
リモートブランチの変更を上流ブランチに反映する  
```
git fetch origin
```
上で上流ブランチに反映させたものを追跡ブランチに反映する
```
git marge
```

上２つをまとめてやりたい場合
```
git pull
```

## 一からリポジトリを作成する
作業ディレクトリに移動して
```
git init
```
そのあとの流れは今までと同様

### その他
* ファイルを削除したい  
git管理したファイルはワーキングディレクトリ普通にで削除しても、  リモートリポジトリでは削除できない  
以下コマンドを実施する
```
# 削除
git rm <削除したいファイル>
# 削除したファイルをcommit
git commit -m <コミットメッセージ>
# push
git push -u origin <ブランチ名>
```
これでリモートリポジトリから削除できる
****
* pushを取り消したい  
commit履歴ごと削除する方法もあるが、望ましくないので割愛  
まずはcommitを取り消す
```
git revert <commitハッシュ値>
```
※ハッシュ値はgit logコマンドで確認  
※commitしたことは消えず、履歴にこのcommitを取り消したよという履歴が追加される  
その後pushする
```
git push -u origin <ブランチ名>
```
