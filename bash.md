# bash備忘録
調べたことを適宜まとめる  
100行くらい書いたら、別のマークダウンに纏めるようにしたい。。

* シェバング  
bashを"./~.sh"で実行できるようにする
```
#!/bin/bash -x
```  
-x を付ければ変数とかコマンドを表示してくれる

* カレントディレクトリ
```
WORK_DIR=$(cd $(dirname $0); pwd)
```

* 特殊な変数   

|変数|機能|
|---|---|
|$0|スクリプト名|
|$1 ~ $9|引数、1番目の引数を$1、2番目の引数を$2でアクセスする|
|$#|スクリプトに与えた引数の数|
|$*|全部の引数をまとめて1つとして処理|
|$@|全部の引数を個別として処理|
|$?|直前実行したコマンドの終了値（0は成功、1は失敗)|
|$$|このシェルスクリプトのプロセスID|
|$!|最後に実行したバックグラウンドプロセスID|

* &&と||を使った直前コマンド成功判定  
```
# mkdirが成功ならexit 0で終了
mkdir WORK_DIR && exit 0
# mkdirが失敗ならexit 1で終了
mkdir WORK_DIR || exit 1
```

* ファイルの行数判定
```
# result.txtの行数が0行ならexit1で終了する
if [ $(cat result.txt | wc -l ) -eq 0 ]; then
        exit 1
fi
```

* エラー結果も出力する  
```
# commandの結果をエラー含めlogにリダイレクトする
command 2>&1 > log
```

